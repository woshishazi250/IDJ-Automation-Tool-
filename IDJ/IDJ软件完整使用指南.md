# IDJ脚本自动化软件 - 完整使用指南

## 🚀 快速开始

### 1. 启动软件
```bash
python main.py
```

启动成功后，你会看到：
- ✅ 图像识别模块初始化成功
- ✅ 鼠标控制模块初始化成功  
- ✅ 键盘控制模块初始化成功
- ✅ 全局快捷键Ctrl+Shift+S已注册
- ✅ IDJ脚本自动化软件启动成功

### 2. 界面布局
- **左侧**：积木库（按功能分类的积木）
- **中间**：脚本编辑区（拖拽积木到这里）
- **右侧**：属性编辑器（配置积木参数）
- **底部**：控制按钮（开始、暂停、停止等）

## 🧩 积木类型详解

### 事件积木（黄色系）
#### 🚀 启动脚本
- **用途**：脚本的入口点
- **形状**：帽子形状（弧形顶部）
- **属性**：
  - 脚本名称
  - 自动启动
  - 快捷键（可选）

#### 📢 广播消息
- **用途**：向其他脚本发送消息
- **属性**：
  - 消息名称
  - 延迟发送时间

#### 📻 接收消息
- **用途**：等待接收指定消息
- **属性**：
  - 监听消息名称
  - 超时时间

### 控制积木（橙色系）
#### 🔄 循环 - 新增强功能！
- **形状**：C形状容器积木
- **类型选择**：
  1. **计数循环**：执行指定次数
     - 循环次数：1-1000次
     - 延迟时间：每次循环间隔
  
  2. **永远重复**：无限循环 🆕
     - 延迟时间：每次循环间隔
     - 注意：需要手动停止脚本
  
  3. **重复直到条件满足**：条件循环 🆕
     - 条件类型：
       - 找到图像：等待指定图像出现
       - 找到文字：等待指定文字出现
       - 位置匹配：预留扩展接口
     - 条件值：图像文件路径或文字内容
     - 匹配阈值：0.1-1.0
     - 安全机制：最大1000次后自动停止

#### ❓ 条件判断
- **形状**：C形状容器积木
- **用途**：根据条件执行不同操作
- **属性**：
  - 条件类型
  - 匹配阈值

#### 🔧 函数定义
- **形状**：C形状容器积木
- **用途**：定义可重用的代码块
- **属性**：
  - 函数名称
  - 参数列表

#### ⏰ 等待
- **用途**：暂停执行指定时间
- **属性**：
  - 等待时间（秒）

### 动作积木（蓝色系）
#### 🖱️ 鼠标移动
- **用途**：移动鼠标到指定位置
- **属性**：
  - X坐标、Y坐标
  - 移动时间
  - 快速选择位置按钮

#### 🖱️ 鼠标点击
- **用途**：在指定位置点击鼠标
- **属性**：
  - X坐标、Y坐标
  - 鼠标按键（左键/右键/中键）
  - 点击次数
  - 延迟时间
  - 快速选择位置按钮

#### 🖱️ 鼠标拖拽
- **用途**：从起始位置拖拽到结束位置
- **属性**：
  - 起始坐标、结束坐标
  - 拖拽时间
  - 随机偏移范围
  - 快速录制拖拽按钮

### 键盘积木（深蓝色系）
#### ⌨️ 键盘输入
- **用途**：输入文字内容
- **属性**：
  - 输入文字
  - 输入延迟

#### ⌨️ 键盘按键
- **用途**：按下特殊按键
- **支持按键**：
  - 功能键：F1-F12
  - 方向键：上下左右
  - 特殊键：回车、空格、退格、删除、Tab、Esc
  - 导航键：Home、End、Page Up、Page Down
- **属性**：
  - 按键类型
  - 按键次数
  - 按键间隔

### 图像积木（紫色系）
#### 🔍 查找图像
- **用途**：在屏幕上查找指定图像
- **属性**：
  - 图像路径（浏览文件或快速截图）
  - 匹配阈值
  - 找到后的动作（点击/移动/忽略）

#### 🔍 查找文字
- **用途**：在屏幕上查找指定文字
- **属性**：
  - 查找文本
  - 字体设置
  - 匹配阈值
  - 找到后的动作

### 逻辑积木（绿色系）
#### ➕ 与运算、或运算、非运算
- **用途**：逻辑条件组合
- **属性**：
  - 操作数
  - 条件类型
  - 匹配阈值

## 🎯 实用操作指南

### 创建基础脚本
1. **拖拽启动积木**到编辑区
2. **设置脚本名称**在属性编辑器中
3. **添加操作积木**（如鼠标点击）
4. **配置积木属性**（坐标、延迟等）
5. **点击开始按钮**执行脚本

### 使用新的循环功能 🆕

#### 创建计数循环
```
启动脚本 → 循环（计数循环，5次） → 鼠标点击 → 等待1秒
```

#### 创建永远循环
```
启动脚本 → 循环（永远重复） → 查找图像 → 鼠标点击
```
⚠️ 注意：永远循环需要手动停止脚本

#### 创建条件循环
```
启动脚本 → 循环（重复直到条件满足）
         ↓ 条件：找到图像"完成按钮.png"
         → 鼠标点击 → 等待2秒
```

### 使用并行执行
1. **创建多个脚本**
2. **使用广播消息**进行脚本间通信
3. **启动脚本组管理器**
4. **同时执行多个任务**

### 使用图像识别
1. **添加查找图像积木**
2. **点击"快速截图"**选择目标图像
3. **调整匹配阈值**（推荐0.8）
4. **设置找到后的动作**

### 使用位置选择器
1. **在鼠标积木中点击"快速选择位置"**
2. **鼠标变为十字光标**
3. **点击目标位置**
4. **坐标自动填入**

## 🔧 高级技巧

### 脚本间通信
```
脚本A: 启动脚本 → 执行操作 → 广播消息"任务完成"
脚本B: 接收消息"任务完成" → 执行后续操作
```

### 条件判断组合
```
启动脚本 → 条件判断（图像存在）
         ├─ 是：执行操作A
         └─ 否：执行操作B
```

### 循环嵌套
```
启动脚本 → 循环（外层，3次）
         └─ 循环（内层，5次）
            └─ 具体操作
```

### 错误处理
```
启动脚本 → 查找图像
         ├─ 找到：点击操作
         └─ 未找到：记录日志
```

## 🛠️ 故障排除

### 常见问题

#### 1. 积木连接不上
- **检查积木形状**：确保是正确的Scratch风格形状
- **检查连接位置**：拖拽到积木的凹凸连接处
- **查看日志**：检查是否有连接错误信息

#### 2. 图像识别失败
- **检查图像质量**：确保截图清晰
- **调整匹配阈值**：降低到0.6-0.7
- **检查屏幕分辨率**：确保与截图时一致

#### 3. 循环无法停止
- **使用条件循环**：设置合理的结束条件
- **检查安全机制**：确认1000次限制是否触发
- **手动停止**：点击停止按钮

#### 4. 脚本执行缓慢
- **调整延迟时间**：减少不必要的等待
- **优化图像识别**：提高匹配阈值
- **减少循环次数**：避免过多重复操作

### 日志查看
- **日志文件**：`idj.log`
- **日志级别**：INFO、ERROR、DEBUG
- **实时监控**：软件运行时查看控制台输出

### 性能优化
- **合理使用延迟**：避免过快或过慢的操作
- **优化图像大小**：使用适当尺寸的截图
- **避免无限循环**：使用条件循环替代永远循环

## 📋 快捷键

- **Ctrl+Shift+S**：全局快捷键（已注册）
- **拖拽积木**：从积木库拖拽到编辑区
- **双击积木**：快速添加到脚本
- **右键菜单**：积木操作选项

## 🎨 界面自定义

### 画布操作
- **自动扩展**：积木超出边界时自动扩展画布
- **滚动查看**：使用滚动条查看大型脚本
- **缩放功能**：调整查看比例

### 积木样式
- **Scratch风格**：真正的Scratch积木形状
- **颜色分类**：不同功能用不同颜色
- **连接高亮**：连接时显示绿色边框

## 📈 最佳实践

### 脚本设计
1. **模块化设计**：将复杂任务分解为小模块
2. **错误处理**：添加适当的条件判断
3. **日志记录**：使用打印积木记录关键信息
4. **测试验证**：先小范围测试再大规模运行

### 性能优化
1. **合理延迟**：给系统足够的响应时间
2. **精确定位**：使用图像识别而非固定坐标
3. **条件退出**：避免无限循环的风险
4. **资源管理**：及时清理不需要的资源

### 维护管理
1. **版本控制**：保存脚本的不同版本
2. **文档记录**：为复杂脚本添加说明
3. **定期测试**：确保脚本在环境变化后仍能正常工作
4. **备份重要脚本**：防止意外丢失

---

**IDJ脚本自动化软件** - 让自动化变得简单而强大！

🎉 现在你已经掌握了所有功能，开始创建你的自动化脚本吧！