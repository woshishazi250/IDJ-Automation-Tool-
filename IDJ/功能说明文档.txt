IDJ 脚本自动化软件功能说明文档
================================

软件名称：IDJ 脚本自动化软件
版本：1.0.0
更新日期：2026年01月07日
开发语言：Python 3 + PyQt5


一、软件概述
-------------
IDJ是一款功能完整的脚本自动化软件，支持可视化积木编程和代码编程两种模式，
帮助用户快速实现各种自动化任务，如游戏辅助、软件测试、数据处理等。


二、核心功能模块
-------------

### 1. 窗口绑定功能
#### 功能说明
- 自动检测并列出当前系统中所有可见窗口
- 支持选择并绑定目标窗口，确保脚本执行时的稳定性
- 实时监控绑定窗口的状态变化
- 窗口列表定期自动刷新（每5秒）

#### 操作步骤
1. 点击"刷新窗口列表"按钮获取所有可见窗口
2. 在列表中选择目标窗口
3. 点击"绑定选中窗口"完成绑定
4. 绑定成功后会显示窗口标题和进程名称


### 2. 脚本管理功能
#### 功能说明
- 支持创建、加载、保存脚本
- 脚本格式支持JSON（积木模式）和Python（代码模式）
- 提供脚本执行控制按钮（开始、暂停、停止、保存）

#### 脚本格式
- **JSON格式**：适合积木模式，包含积木配置信息
- **Python格式**：适合代码模式，支持完整的Python语法


### 3. 可视化编程（积木模式）
#### 功能说明
- 提供类似Scratch的可视化积木编程界面
- 支持多种类型的积木块，包括循环、条件、鼠标操作、键盘操作等
- 积木块可拖动、连接、组合，形成完整的执行流程
- 实时生成可执行的Python代码

#### 支持的积木类型
##### 控制积木
- **循环积木**：支持设定循环次数和延迟时间
- **条件积木**：支持if条件判断
- **函数积木**：支持自定义函数定义
- **跳转积木**：支持绝对跳转和相对跳转
- **延迟积木**：支持设定等待时间

##### 输入输出积木
- **鼠标移动**：支持坐标移动，可选随机偏移
- **鼠标点击**：支持左键、右键点击，可选点击次数和延迟
- **鼠标拖拽**：支持起始和结束坐标拖拽，可选随机偏移
- **键盘输入**：支持输入文本，可选字符延迟

##### 图像识别积木
- **图像查找**：支持根据图像文件查找匹配位置
- **文字识别**：支持查找特定文字位置
- **图像匹配**：支持图像匹配和点击操作

##### 逻辑运算积木
- **逻辑与**：AND运算
- **逻辑或**：OR运算  
- **逻辑非**：NOT运算

##### 计时积木
- **定时器**：支持设定定时时长
- **秒表**：支持秒表启动、停止、重置操作


### 4. 代码编程（代码模式）
#### 功能说明
- 提供Python代码编辑器，支持完整的Python语法
- 支持自定义代码编写和执行
- 支持代码高亮和基础编辑功能
- 执行过程中实时显示当前步骤

#### 代码模式特点
- 支持所有Python标准库和第三方库
- 提供预导入的模块（鼠标控制、键盘控制、图像识别等）
- 支持自定义模块导入


### 5. 执行控制功能
#### 功能说明
- **开始执行**：启动脚本执行
- **暂停执行**：暂停当前正在执行的脚本
- **停止执行**：停止脚本执行
- **进度显示**：显示执行进度条
- **步骤显示**：显示当前执行的步骤名称
- **状态显示**：显示执行状态（就绪、执行中、暂停中、已停止、执行完成）

#### 执行特性
- 独立线程执行，不阻塞UI界面
- 实时捕获执行错误并显示
- 支持执行过程中的调试输出


### 6. 图像识别功能
#### 功能说明
- 基于OpenCV和OCR技术的图像识别
- 支持图像匹配和文字识别
- 支持设定匹配阈值和区域搜索
- 支持查找成功后的点击操作

#### 使用场景
- 游戏辅助中的图像识别
- 软件测试中的界面元素定位
- 数据处理中的图像内容识别


### 7. 截图工具
#### 功能说明
- 快速区域截图功能（快捷键：Ctrl+Shift+S）
- 支持自定义截图区域
- 支持截图保存和预览
- 支持截图后自动显示主窗口

#### 截图模式
- **快速区域截图**：隐藏主窗口，捕获指定区域
- **窗口截图**：捕获绑定窗口的内容
- **全屏截图**：捕获整个屏幕内容


### 8. 全局快捷键
#### 功能说明
- 提供快速截图快捷键：Ctrl+Shift+S
- 支持在任何界面下快速启动截图工具
- 截图完成后自动返回主窗口


三、执行流程
-------------

### 积木模式执行流程
1. 在积木编辑器中拖拽积木块
2. 配置积木属性（如坐标、延迟时间等）
3. 连接积木形成执行流程
4. 点击"开始执行"按钮
5. 程序在独立线程中执行脚本
6. 实时显示执行步骤和进度
7. 执行完成后显示结果

### 代码模式执行流程
1. 在代码编辑器中编写Python代码
2. 点击"开始执行"按钮
3. 程序在独立线程中执行代码
4. 实时显示执行步骤和进度
5. 执行完成后显示结果


四、技术特性
-------------
- **多线程执行**：脚本执行在独立线程中，不阻塞UI
- **信号槽机制**：使用PyQt5信号槽实现线程间通信
- **可视化编程**：Scratch风格的积木编程界面
- **实时更新**：执行过程中实时显示步骤和状态
- **错误处理**：完善的错误捕获和显示机制
- **日志系统**：详细的日志记录功能（idj.log文件）
- **跨平台支持**：支持Windows、Linux、Mac OS（部分功能）


五、文件说明
-------------

### 主要文件
- `main.py`：程序入口文件
- `src/ui/main_window.py`：主窗口界面实现
- `src/blocks/block_editor.py`：积木编辑器模块
- `src/core/window_detector.py`：窗口检测模块
- `src/modules/image_recognition.py`：图像识别模块
- `src/modules/mouse_control.py`：鼠标控制模块
- `src/modules/keyboard_control.py`：键盘控制模块
- `src/modules/screenshot_tool.py`：截图工具模块
- `idj.log`：程序运行日志文件


六、使用建议
-------------

### 最佳实践
1. 在执行脚本前先绑定目标窗口
2. 使用积木模式快速创建简单脚本
3. 复杂脚本使用代码模式实现
4. 定期保存脚本以防数据丢失
5. 查看日志文件获取详细执行信息

### 注意事项
1. 确保绑定的窗口在执行过程中保持可见
2. 图像识别需要高质量的模板图像
3. 避免在执行过程中频繁切换窗口
4. 大循环和长时间操作会影响系统性能


七、更新历史
-------------
- **2026-01-07**：添加显示当前执行步骤功能
- **之前版本**：截图功能修复、Unicode解码错误修复


================================
IDJ脚本自动化软件 - 让自动化变得简单！
================================